<ng-include src="'/static/partials/pageHeaderWidget.html'"></ng-include>

<div class="container" id="galaxy-role-detail">

    <div class="row" style="margin-bottom: 20px;" ng-show="my_info.staff">
        <div class="col-lg-12">
            <div class="text-right">
                <a class="btn btn-danger btn-sm" href ng-click="staffDeleteRole(role.id)"><i class="fa fa-trash-o"></i> Delete Role</a>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-6">
            <h2 class="rolename">{{role.name}}</h2>
            <div class="description">{{role.description}}</div>
        </div>
        <div class="col-xs-6 text-right">
            <div class="user-info">
                <a href="/detail#/user/{{role.summary_fields.owner.id}}"><img ng-src="{{ role.summary_fields.owner.avatar_url }}" /></a>
                <p class="username"><a href="/detail#/user/{{role.summary_fields.owner.id}}">{{role.summary_fields.owner.username}}</a><br \>
                    <span ng-show="role.summary_fields.owner.staff" class="staff-marker"><i class="fa fa-asterisk"></i> Ansible Staff</span></p>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <div class="documentation">
                <tabset type="pills">
                    <tab heading="Details">
                        <div class="row rating-section">
                            <div class="col-lg-3 col-md-6 col-sm-6">
                                <div class="score" ng-class="{ 'add-margin': my_info.authenticated }">
                                   <span ng-show="role.average_score == '0.0'" class="score-value-na">NA</span>
                                   <span ng-show="role.average_score != '0.0'" class="score-value">{{ role.average_score }}</span>
                                   <span class="fld-label">Score</span>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <div class="ratings-count">
                                    <h3>Ratings: <span ng-class="{ 'count-grey': role.num_ratings == 0, 'count-blue': role.num_ratings }">{{ role.num_ratings }}</span></h3>
                                    <p ng-show="my_info.authenticated">
                                        <a href="" ng-click="showRatingDialog()" ng-show="role.num_ratings == 0">Be the first to rate this role.</a>
                                        <a href="" ng-click="showRatingDialog()" ng-show="role.num_ratings">Rate this role.</a>
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <a ng-show="my_info.authenticated" class="btn btn-success" ng-click="showRatingDialog()"><i class="fa fa-star-half-empty"></i> Rate This Role</a>
                                <a class="btn btn-default" ng-href="{{ role.issue_tracker_url }}"
                                   ng-show="role.issue_tracker_url" target="_blank"><i class="fa fa-bug"></i> Issue Tracker</a>
                                <div class="inline-block" ng-show="!role.issue_tracker_url" tooltip="This role does not have an issue tracker. Members can write a review to notify the author about issues." tooltip-placement="top"><a class="btn btn-default" ng-href="{{ role.issue_tracker_url }}" ng-disabled="true"><i class="fa fa-bug"></i> Issue Tracker</a></div>
                                <a class="btn btn-default" ng-href="https://github.com/{{role.github_user}}/{{role.github_repo}}" target="_blank"><i class="fa fa-github"></i> Github Repo</a>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6">
                                <div class="ansible-version">
                                    <h3>Minimum Ansible Version</h3>
                                    {{ role.min_ansible_version }}
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="installation">
                                    <h3>Installation</h3>
                                    <code>$ ansible-galaxy install {{role.summary_fields.owner.username}}.{{role.name}}</code>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row" ng-show="role.tags && role.tags.length">
                            <div class="col-lg-12">
                                <div class="tags-container">
                                    <div class="title">Tags</div>
                                    <div ng-repeat="tag in role.tags" class="galaxy-tag">{{ tag }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-md-6" ng-if="role.summary_fields.versions">
                                <div class="versions" ng-show="role.summary_fields.versions.length > 0">
                                    <table class="table ga-table-striped">
                                        <caption>Version History</caption>
                                        <thead>
                                            <tr>
                                                <th>Version</th>
                                                <th>Release Date</th>
                                            </tr>
                                        </thead>
                                    </table>
                                    <div class="table-scroller">
                                        <table class="table ga-table-striped">
                                            <tbody>
                                            <tr ng-repeat="version in role.summary_fields.versions">
                                                <td>{{ version.name }}</td>
                                                <td>{{ version.release_date | date:"short" }}</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6">
                                <div class="platforms" ng-show="role.summary_fields.platforms && role.summary_fields.platforms.length > 0">
                                    <table class="table ga-table-striped">
                                        <caption>Supported Platforms</caption>
                                        <thead>
                                            <tr>
                                                <th>Platform</th>
                                                <th>Version</th>
                                            </tr>
                                        </thead>
                                    </table>
                                    <div class="table-scroller">
                                        <table class="table ga-table-striped">
                                            <tbody>
                                            <tr ng-repeat="platform in role.summary_fields.platforms">
                                                <td>{{ platform.name }}</td>
                                                <td>{{ platform.release }}</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-md-6">
                                <div class="dependencies" ng-show="role.summary_fields.dependencies.length > 0">
                                    <table class="table ga-table-striped">
                                        <caption>Dependencies</caption>
                                        <thead>
                                            <tr>
                                                <th>Role</th>
                                            </tr>
                                        </thead>
                                    </table>
                                    <div class="table-scroller">
                                        <table class="table ga-table-striped">
                                            <tbody>
                                            <tr ng-repeat="dependency in role.summary_fields.dependencies">
                                                <td><a href="/detail#/role/{{ dependency.id }}">{{ dependency.name }}</a></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div> 
                        </div>

                    </tab>

                    <tab heading="README">
                        <div ng-bind-html="role.readme_html" class="readme"></div>
                    </tab>
                    <tab>
                        <tab-heading>Reviews <span class="badge">{{ role.num_ratings }}</span></tab-heading>
                        <ng-include src="'/static/partials/ratingListTable.html'"></ng-include>
                    </tab>
                </tabset>
            </div>
        </div>
    </div>
</div> <!-- end container -->
