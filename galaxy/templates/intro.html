{% extends 'base.html' %}

{% load galaxyhelpers %}

{% block general_content %}

<div id="galaxy-page-title">
    <div class="container-fluid">
        <div class="page-title">
            {{ request.path | urlname }}
        </div>
    </div>
</div>

<div class="container-fluid" id="galaxy-intro-page">
    <div class="row">
        <div class="col-lg-3 col-md-3">
            <nav class="galaxy-intro-links hidden-sm hidden-xs" data-spy="affix" data-offset-top="160">
                <div class="galaxy-nav-title">
                    <i class="fa fa-bars"></i> MENU
                    <hr />
                </div>
                <ul class="nav" role="tablist">
                    <li><a href="#welcome">Welcome</a></li>
                    <li><a href="#download">Download Roles</a></li>
                    <li class="pad"><a href="#download-multiple">Download Multiple Roles</a></li>
                    <li class="pad"><a href="#download-advanced">Advanced Downloading</a></li>
                    <li><a href="#review">Review</a></li>
                    <li><a href="#share">Share</a></li>
                    <li class="pad"><a href="#create-role">Create a Role</a>
                        <ul class="nav">
                            <li class="pad"><a href="#readme">README.md</a></li>
                            <li class="pad"><a href="#meta">Meta Data</a></li>
                            <li class="pad"><a href="#dependencies">Dependencies</a></li>
                            <li class="pad"><a href="#tags">Categories/Tags</a></li>
                            <li class="pad"><a href="#variables">Variable Names</a></li>
                        </ul>
                    </li>
                    <li class="pad"><a href="#role-test">Test</a></li>
                    <li class="pad"><a href="#role-github">Upload to Github</a></li>
                    <li class="pad"><a href="#role-galaxy">Upload to Galaxy</a></li>
                    <li><a href="#questions">Questions</a></li>
                    <li class="back-to-top-link"><a href="#"><i class="fa fa-chevron-circle-up"></i> BACK TO TOP</a></li>
                </ul>
            </nav>
        </div>
        <div class="col-lg-9 col-md-9">
            <div class="intro-content">
                <h2 id="welcome">Welcome to Ansible Galaxy</h2>

                <p>Ansible Galaxy is Ansible’s official community hub for sharing Ansible roles. A role is the Ansible way of bundling automation content and making it reusable.</p>
                <p>If you're not familiar with the Ansible role concept, think of include files used in a programming language. An include file allows the programmer to organize code into reusable modules.
                  Code can be organized into smaller files and grouped by subject matter or function. These discrete pieces of code can then be included as needed into larger programs like building blocks.</p>
                <p>A role is similar. Instead of creating giant playbooks with hundreds of tasks we can use roles to organize tasks, breaking them apart into smaller more discrete units of work. But a role is more than
                    just an include file. A role is all the tasks, variables and handlers needed to complete the unit of work. This allows a role to be completely self contained or encapsulated and completely reusable.</p>
                <p>Using roles also allows us to think about node configuration in terms of modeling. For example, given a set of nodes that should be web servers we can simply apply a web server role to them. We don't have
                    to think about or write all the tasks needed to configure web servers. All the details are already encapsulated in a web server role - a role you downloaded from Galaxy.</p>

                <h3 id="download">Download Roles</h3>

                <p>You can find the most popular roles and recently added roles on the <a href="/explore#/">Explore</a> page, or use <a href="/list#/roles">Browse Roles</a> to search all roles available on Galaxy.</p>
                <p>Download a role onto your Ansible host using the <code>ansible-galaxy</code> command that comes bundled with Ansible.</p>
                <p>For example:</p>

<pre>
$ ansible-galaxy install username.rolename
</pre>

                <h4 id="download-multiple">Download Multiple Roles</h4>

                <p>A list of roles can be specified in a file. Provide roles one per line in the format <code>username.rolename[,version]</code>.</p>
                <p>For example:</p>

<pre>
# roles.txt
user1.role1,v1.0.0
user2.role2,v0.5
user2.role3
</pre>
                <p>Install the roles:</p>
<pre>
$ ansible-galaxy install -r roles.txt
</pre>
                <h4 id="download-advanced">Advanced Downloading</h4>

                <p>Starting in Ansible 1.8 you can download roles from sources other than Galaxy, and control the install path and installed name. To use these
                    features you will need to create a Yaml file with a <code>.yml</code> extension<p>
                <p>For example:</p>
<pre>
# install_roles.yml

# from galaxy
- src: yatesr.timezone

# from github
- src: https://github.com/bennojoy/nginx

# from github installing to a relative path
- src: https://github.com/bennojoy/nginx
  path: vagrant/roles/

# from github, overriding the name and specifying a specific tag
- src: https://github.com/bennojoy/nginx
  version: master
  name: nginx_role

# from a webserver, where the role is packaged in a tar.gz
- src: https://some.webserver.example.com/files/master.tar.gz
  name: http-role

# from bitbucket, if bitbucket happens to be operational right now :)
- src: git+http://bitbucket.org/willthames/git-ansible-galaxy
  version: v1.4

# from bitbucket, alternative syntax and caveats
- src: http://bitbucket.org/willthames/hg-ansible-galaxy
  scm: hg
</pre>

                <p>Install the roles:</p>

<pre>
$ ansible-galaxy install -r install_roles.yml
</pre>

                <h3 id="review">Review Roles</h3>

                <p>Once you’ve downloaded and used a role, let others know what you think by providing a review. A review includes a score and a comment.<p>

                <p>Picking a score is pretty simple. Just choose from one of the following options:</p>
                <ol>
                    <li>Needs work.</li>
                    <li>OK, but could be improved some.</li>
                    <li>Nice.</li>
                    <li>Awesome!</li>
                    <li>Dude, I owe you a beer!</li>
                </ol>
                <p>You can optionally provide a comment as well. Take the opportunity to write a line or two about your experience with the role and how it helped you. Let others know what to expect when they download and use the role.</p>

                <h3 id="share">Share Roles</h3>
                <p>Share roles you create with the community. Roles can inlcude deploying popular applications, as well as automation around a product your company makes.</p>

                <h4 id="create-role">Create a Role</h4>
                <p>Let's suppose we want to create a role called acme that will install the Acme web server. Start by <a href="https://help.github.com/articles/create-a-repo">creating a new repository on github</a>.  Once created, clone the repository locally:</p>

<pre>
$ git clone https://username@github.com/username/ansible-role-acme.git acme
</pre>

                <p>Next, use <code>ansible-galaxy</code> to create the role scaffolding:</p>

<pre>
$ ansible-galaxy init acme --force
</pre>
                <p>This creates the directory structure needed for organizing your code:<p>
<pre>
acme/
    defaults/
    files/
    handlers/
    meta/
    tasks/
    templates/
    vars/
    README.md
</pre>
                <p>For more about developing a role and what goes into each of the components refer to
                 <a href="http://docs.ansible.com/ansible/playbooks_roles.html#roles" target="_blank">Roles on the Ansible Docs site</a>.
                </p>
                <h5>Good Practices</h5>
                <p>When developing a role there are a few practices you should always follow to help potential users discover your role and
                    make it easy for them to get started:</p>
                <ul>
                    <li>Provide clear documentation in the README.md.</li>
                    <li>Give accurate information in meta/main.yml.</li>
                    <li>Include dependencies in meta/main.yml.</li>
                    <li>Prefix variable names with the role name.</li>
                    <li>Test, test, test!</li>
                </ul>
                <p>Sticking to these practices will help you create great roles. The community will love you, and you'll be hero!</p>

                <h5 id="readme">README.md</h5>
                <p>The init command provides a template README.md file. Tailor it to fit your role. This is your chance to
                  provide potential users what they need to get started using the role.</p>
                <p>The file is composed in <a href="https://help.github.com/articles/markdown-basics/" target="_blank">Github markdown</a>.
                    Make modifications to the file using markdown to ensure the document looks good on Galaxy and on Github.</p>
                <p>For example:</p>

<pre>
# README.md
# Ansible Role: Acme 2.x

An Ansible role that installs Acme 2.x on Centos 7.x

## Requirements

If you are using SSL/TLS, you will need to provide your own certificate and key files. You can generate a self-signed certificate with a command like `openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout example.key -out example.crt`.

## Role Variables

Available variables are listed below, along with default values:

    acme_listen_port: 80
    acme_listen_port_ssl: 443

## Dependencies

- username.iptables - configure the firewall and block all ports except those needed for the web server and ssh access.
- username.common - perform common server configuration

## Example Playbook

    - hosts: webservers
      roles:
        - { role: username.acme }

## License

MIT
</pre>
                <h5 id="meta">Meta Data - meta/main.yml</h5>

                <p>In meta/main.yml is where you fill in details about supported platforms, minimum required Ansible version, tags
                    that describe the role, dependencies, and information about you the author. All this information will appear on Galaxy. If it's
                    not accurate, users will not be able to find your role.</p>
                <p>Using <code>ansible-galaxy init</code> provides a template meta/main.yml for you to modify. It's written in <a href="http://www.yaml.org" target="_blank">yaml</a>, so be sure to follow the yaml standard as you make changes.</p>
                <p>A modified meta.yml file for our example would look like the following:</p>

<pre>
---
galaxy_info:
  author: John Doe
  description: Quick and easy acme web installer.
  company: Acme
  license: MIT
  min_ansible_version: 1.9
  platforms:
  - name: EL
    versions:
    - all
  galaxy_tags:
    - acme
    - installer
    - web
dependencies:
  - { role: username.common, some_parameter: 3 }
  - { role: username.iptables, open_port: 80 }
</pre>
                <h5 id="tags">Categories/Tags</h5>
                <p>Categories have been replaced by Tags. Adding a role to Galaxy will accept a list of either <em>categories:</em> or <em>galaxy_tags:</em>. However, this change will not be reflected in ansible-galaxy until version 2.0 of ansible. This means your template meta/main.yml may contain <em>categories:</em>, and that's OK.</p>
                <p>Regardless of which version of ansible you are running you can specify either <em>categories:</em> or <em>galaxy_tags:</em> in meta/main.yml. When adding the role to Galaxy the list will be treated as a list of tags. You can provide any tag values you feel will help users find your role. The number of tags imported by Galaxy is limited to 20, and tag values containing non-alphanumeric characters will be ignored.</p>
                <p>Tag values containing a : will be split into multiple tags. The tag <em>cloud:ec2</em>, for example, will become two tags: <em>cloud</em> and <em>ec2</em>.</p>
                <p>The idea behind tags of course is to help Galaxy users find your role. Provide multiple tags relevant to your role. Include broad terms such as <em>database</em> or <em>networking</em> along with more specific keywords like: <em>MySql</em>, <em>Cisco</em>, <em>ASR</em>, <em>TFTP</em>, etc.</p>
                <h5 id="dependencies">Dependencies</h5>
                <p>Ansible uses the dependencies section of meta/main.yml to download and apply any dependent roles. Add one or more dependent roles that Ansible will download and execute before running your role. Dependent role names are specified using the Galaxy author's username and the name of the role in the format <em>username.rolename</em>.</p>
                <p>For example:</p>
<pre>
dependencies:
  - { role: stouts.elasticsearch }
</pre>
                <p>Parameters can also be passed to the role:</p>
<pre>
dependencies:
  - { role: stouts.elasticsearch, elasticsearch_home: &quot;&#123;&#123; install_path_variable &#125;&#125;&quot;, elasticsearch_http_port: 8900 }
</pre>
                <p>For more on how Ansible handles role dependencies, see
                    <a href="http://docs.ansible.com/ansible/playbooks_roles.html#role-dependencies" target="_blank">Role Dependencies</a> at the Ansible 
                    docs site.</a>.<p>

                <h5 id="variables">Variable Names</h5>
                <p>A special note on naming variables within your role. This applies to variables defined in <code>defaults/main.yml</code> and <code>vars/main.yml</code>.
                <div class="alert alert-info"><p><strong>Note:</strong> Prefix variable names with the role name. Adding the role name
                    prevents variable name collision between roles. For example, use <code>rolname_foo</code> rather than <code>foo</code>.</p>
                </div>

                <h4 id="role-test">Test</h4>
                <p>Once you are happy with your role, test it in a playbook, and make sure it’s really ready to go.</p>
<pre>
# test.yml
# test playbook
- hosts: example
  roles:
  - { role: acme, param1: 42 }
</pre>
<pre>
$ ansible-playbook test.yml
</pre>

                <h4 id="role-github">Upload to Github</h4>
                <p>Before you can share the role on Galaxy it needs to exist on Github. Once you finish development and testing
                push your latest changes up to Github by running the following from within the project directory:</p>
<pre>
$ git commit -a
$ git push
</pre>
                <h4 id="role-galaxy">Upload to Galaxy</h4>

                <p>Log into Galaxy and click the <code>Add a Role</code> menu option. Provide your GitHub username and the name of the Github repository, and Galaxy will import your role, making it available to the Galaxy community.</p>

                <p>If you applied any tags to your repository, Galaxy will automatically display a “version” for each tag.  This means users can choose the version (tag) to download.</p>

                <p>The default behavior, if there are no tags, is to make the “HEAD” version available.  This means users downloading the role will always get the latest from the github repository.</p>

                <p>To import new tags, you can trigger a re-import from the “Your Roles” page anytime.</p>

                <h3 id="questions">Questions?</h3>

                <p>If you have unanswered Galaxy questions, feel free to ask on the <a href="https://groups.google.com/forum/#!forum/ansible-project" target="_blank">Ansible mailing list</a>.</p>
                <div class="alert alert-info">
                    <p><strong>Note:</strong> Contents, usage and bugs related to specific roles will not be supported on the mailing list. Contact the role author via GitHub. The role details provided in Galaxy include a link to the Github repository, and when available, the issue tracker.</p>
                </div>
            </div><!-- intro-content -->
        </div><!-- col-lg-9 -->
    </div><!-- row -->
</div>
{% endblock %}
